#!/bin/bash

# Massimo Lauria, 2010, 2011, 2012
#
# Common enviroment variables to be loaded in bash, zsh, X11, ...
#

# Where everything starts
CONFIGDIR=$HOME/config

# {{{ Paths --------------------------------------------------------------------

# Those are useful for MacPorts
if [ -d /opt/local/bin ]; then
    PATH=/opt/local/bin:$PATH
fi

if [ -d /opt/local/sbin ]; then
    PATH=/opt/local/sbin:$PATH
fi

# Emacs paths on MacOSX
if [ `uname` = "Darwin" ]; then
    for emacsapp in Emacs.app Aquamacs.app; do
        if [ -d "/Applications/$emacsapp" ]; then
            PATH="/Applications/$emacsapp/Contents/MacOS/bin:$PATH"
            alias emacs="open -a $emacsapp"
            break
        fi
    done
fi

# A user local fs hierarchy is common in ~/.local/
if [ -d $HOME/.local/bin ]; then
    PATH=$HOME/.local/bin:$PATH
fi


# }}} --------------------------------------------------------------------------




# {{{ Aliases ------------------------------------------------------------------

# if [ "$TERM" != "dumb" -a -f `which dircolors 2>/dev/null` ]; then
#     eval "`dircolors -b`"
#     alias ls='ls --color=auto'
# fi
# alias rm="rm -iv"

# }}} --------------------------------------------------------------------------


# {{{ Pager --------------------------------------------------------------------
if [[ -f `which most 2>/dev/null` ]]; then
    PAGER=most
elif [[ -f `which less 2>/dev/null` ]]; then
    PAGER=less
else
    PAGER=more
fi
export PAGER
# }}} --------------------------------------------------------------------------

# {{{ Editor -------------------------------------------------------------------

if [ `uname` = "Darwin" ]; then
    alias EDITOR="open -t"
else
    alias EDITOR="emacsclient -t"
fi


if [[ -f `which jed 2>/dev/null` ]]; then
    ALTERNATE_EDITOR="jed"
elif [[ -f `which zile 2>/dev/null` ]]; then
    ALTERNATE_EDITOR="zile"
elif [[ -f `which mg 2>/dev/null` ]]; then
    ALTERNATE_EDITOR="mg"
elif [[ -f `which vim 2>/dev/null` ]]; then
    ALTERNATE_EDITOR="vim"
else
    ALTERNATE_EDITOR="vi"
fi

# Never use terminal emacs on Mac...
if [ `uname` = "Darwin" ]; then
    alias ec="emacsclient"
else
    alias ec="emacsclient -t"
fi
alias ecx="emacsclient -n -c"


export EDITOR
export ALTERNATE_EDITOR


# LaTeX enviroment variables
export TEXEDIT='emacsclient -t +%d %s'

TEXMFHOME="$CONFIGDIR/texmf"  # Local packages
if [[ -f `which sage 2>/dev/null` ]]; then
    # Sage TeX packages
    TEXMFHOME="$TEXMFHOME:`sage -root`/local/share/texmf"
fi
export TEXMFHOME



# Customised gtkrc file is loaded.
export GTK2_RC_FILES=$HOME/.gtkrc-2.0


# Do not apply gtk-theme to openoffice
export SAL_USE_VCLPLUGIN=gen


### Include other files
source $CONFIGDIR/shell/shenv-gnupg
# source $CONFIGDIR/shell/shenv-ssh
source $CONFIGDIR/shell/shenv-python


if [ -f "$HOME/personal/conf/shenv-personal" ]; then
	source $HOME/personal/conf/shenv-personal
fi

if [ x`uname` = "xDarwin" ]; then
    source $CONFIGDIR/shell/shenv-macosx
fi

## Umask
umask 0077

## We don't need start/stop terminal
stty stop  '^q'
stty start '^q'
